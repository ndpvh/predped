```{r setup goals, echo = FALSE}

# Create setting
setting <- background(shape = rectangle(center = c(20, 12.5),
                                        size = c(40, 25)), 
                      objects = list(# Special shelves
                                     rectangle(center = c(20, 1.2 / 2), 
                                               size = c(32, 1.2), 
                                               interactable = TRUE),
                                     rectangle(center = c(38, 4),
                                               size = c(1.2, 4),
                                               interactable = TRUE),
                                     rectangle(center = c(39.4, 7.5 + 8.75), 
                                               size = c(1.2, 25 - 7.5), 
                                               interactable = TRUE),
                                     polygon(points = rbind(c(0, 19.5),
                                                            c(0, 25),
                                                            c(16, 25),
                                                            c(16, 22.5),
                                                            c(1.2, 22.5),
                                                            c(1.2, 19.5)),
                                             interactable = TRUE),
                                     rectangle(center = c(1, 14.5),
                                               size = c(2, 1.2),
                                               interactable = TRUE),
                                     polygon(points = rbind(c(0, 3.5), 
                                                            c(0, 11.6),
                                                            c(17, 11.6),
                                                            c(17, 10.4),
                                                            c(1.2, 10.4),
                                                            c(1.2, 3.5)),
                                             interactable = TRUE),
                                     # Bottom left
                                     rectangle(center = c(12, 4),
                                               size = c(12, 1.2),
                                               interactable = TRUE),
                                     rectangle(center = c(12, 7),
                                               size = c(12, 1.2),
                                               interactable = TRUE),
                                     # Top left
                                     rectangle(center = c(12.5, 14),
                                               size = c(13, 1.2),
                                               interactable = TRUE),
                                     rectangle(center = c(12.5, 17),
                                               size = c(13, 1.2),
                                               interactable = TRUE),
                                     rectangle(center = c(12.5, 20),
                                               size = c(13, 1.2),
                                               interactable = TRUE),
                                     # Top right
                                     rectangle(center = c(29, 11),
                                               size = c(14, 1.2),
                                               interactable = TRUE),
                                     rectangle(center = c(29, 14),
                                               size = c(14, 1.2),
                                               interactable = TRUE),
                                     rectangle(center = c(29, 17),
                                               size = c(14, 1.2),
                                               interactable = TRUE),
                                     rectangle(center = c(29, 20),
                                               size = c(14, 1.2),
                                               interactable = TRUE),
                                     rectangle(center = c(29, 23),
                                               size = c(14, 1.2),
                                               interactable = TRUE),
                                     # Bottom right
                                     rectangle(center = c(27, 4),
                                               size = c(12, 1.2),
                                               interactable = TRUE),
                                     rectangle(center = c(27, 7),
                                               size = c(12, 1.2),
                                               interactable = TRUE)),
                      entrance = c(0, 0.5),
                      exit = c(0, 13),
                      same_exit = FALSE)

# Precompute some edges
few_edges <- predped::create_edges(c(0.3, 0.5), c(0, 13), setting, many_options = FALSE)
many_edges <- predped::create_edges(c(0.3, 0.5), c(0, 13), setting, many_options = TRUE)

few_edges$edges <- few_edges$edges[!(few_edges$edges$from %in% c("agent", "goal")),]
few_edges$edges <- few_edges$edges[!(few_edges$edges$to %in% c("agent", "goal")),]
few_edges$nodes <- few_edges$nodes[!(few_edges$nodes$node_ID %in% c("agent", "goal")),]

many_edges$edges <- many_edges$edges[!(many_edges$edges$from %in% c("agent", "goal")),]
many_edges$edges <- many_edges$edges[!(many_edges$edges$to %in% c("agent", "goal")),]
many_edges$nodes <- many_edges$nodes[!(many_edges$nodes$node_ID %in% c("agent", "goal")),]

```

## find_path
```{r goals find_path, echo = FALSE}

# Test `find_path`
test_times(\() find_path(predped::goal(id = "goal exit", position = c(0, 13)),
                         predped::agent(center = c(0.3, 0.5), 
                                        radius = 0.25), 
                         setting, 
                         precomputed_edges = NULL,
                         many_options = FALSE))

test_times(\() find_path(predped::goal(id = "goal exit", position = c(0, 13)),
                         predped::agent(center = c(0.3, 0.5), 
                                        radius = 0.25), 
                         setting, 
                         precomputed_edges = NULL,
                         many_options = TRUE))

test_times(\() find_path(predped::goal(id = "goal exit", position = c(0, 13)),
                         predped::agent(center = c(0.3, 0.5), 
                                        radius = 0.25), 
                         setting, 
                         precomputed_edges = few_edges))

test_times(\() find_path(predped::goal(id = "goal exit", position = c(0, 13)),
                         predped::agent(center = c(0.3, 0.5), 
                                        radius = 0.25), 
                         setting, 
                         precomputed_edges = many_edges))

```